<h1>Create a new article</h1>

<% if @article.errors.any? %>
   <h2>The folowing errors prevent the articles from being saved</h2>
   <ul>
    <% @article.errors.full_messages.each do |msg| %>
        <li><%=msg%></li>  
  
    <%end%>
    </ul>
<%end%>

<div class="container px-4 mt-5">
  <div class="row gx-5">
    <div class="col">
     <div class="p-3">
          <%= form_with scope: :article, url: create_article_path, local:true do |f|%>
            <div class="mb-3">  
              <%= f.label :title, :class=>"form-label"%>
              <%= f.text_field :name, placeholder: "Blog Title" , :class=>"form-control"%>
            </div> 
            <div class="mb-3">
              <%= f.label :description, :class=>"form-label"%>
              <br/>
              <%= f.text_area :body, wrap: "hard", placeholder: "Blog Body" ,:class=>"form-control"%>
            </div>
            <div class="mb-3">
                <%= f.label :Image,:class=>"form-label"%>
                <%= f.file_field :photo,:class=>"form-control form-control-lg"%>
            </div>
            <div class="mb-3">
                <%= f.submit %>
            </div>



          <% end %>
</div>
    </div>
    <div class="col justify-content-center">
      <div class="img-container p-3"> 
       <img class="img-fluid" id="img_prev"  src="<%= asset_path('upload_image.png')%>" alt="">
      </div>
    </div>
  </div>
</div>

    


    <%= link_to 'Cancel and Return to articles listing',articles_path %> 

    <script>
    
    const uploadImageInput = document.getElementById("article_photo")
    const output = document.getElementById('img_prev');
    uploadImageInput.onchange = function(){
        console.log('file change')
        
        var reader = new FileReader();
        reader.onload = function(){
          output.src = reader.result;
        };
        reader.readAsDataURL(event.target.files[0]);
    }
    
    </script>